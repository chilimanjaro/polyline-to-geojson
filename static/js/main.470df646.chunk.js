(this["webpackJsonppolyline-to-geojson"]=this["webpackJsonppolyline-to-geojson"]||[]).push([[0],{13:function(e,t,a){e.exports=a.p+"static/media/loading-animation.80a2dbc6.svg"},14:function(e,t,a){e.exports=a(21)},19:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(11),o=a.n(i),l=(a(19),a(5)),s=a(12),c=a(1),u=a(2),m=a(4),d=a(3),p=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){return e.props.removeError(e.props.index)}),5e3)}},{key:"componentWillUnmount",value:function(){clearTimeout()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"error"},this.props.message," ",r.a.createElement("div",{className:"close",onClick:function(){return e.props.removeError(e.props.index)}}))}}]),a}(n.Component),h=a(23),f=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",Object.assign({id:"drop-area"},this.props.dragProps,{className:this.props.inDragArea?"active":""}),r.a.createElement("input",{id:"file-chooser-input",type:"file",accept:".csv",onChange:function(t){return e.props.handleFile(t.target.files[0])}}),r.a.createElement("label",{className:"drag-area-button",htmlFor:"file-chooser-input"},"Drag your file here or click here to choose it from the list."),r.a.createElement("div",{id:"drag-area-overlay",className:this.props.inDragArea?"active":""},r.a.createElement("div",{className:"drag-area-overlay-text"},"Drop your file here.")))}}]),a}(n.Component),g=a(8),v=a.n(g),E=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleDragEnter=function(e){e.preventDefault(),e.stopPropagation(),n.dragDepth++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&n.setState({inDragArea:!0})},n.handleDragLeave=function(e){e.preventDefault(),e.stopPropagation(),n.dragDepth--,n.dragDepth>0||n.setState({inDragArea:!1})},n.handleDragOver=function(e){e.preventDefault(),e.stopPropagation()},n.handleDrop=function(e){e.preventDefault(),e.stopPropagation(),n.setState({inDragArea:!1}),e.dataTransfer.items&&e.dataTransfer.items.length>0&&(e.dataTransfer.items.length>1?n.showError("Dragged too many files."):n.handleFile(e.dataTransfer.files[0]),e.dataTransfer.clearData(),n.dragDepth=0)},n.handleFile=function(e){if(null!==e&&void 0!==e){if("text/csv"!==e.type)return n.showError("Uploaded file is not a CSV file.");n.props.handleIsFileLoading(!0);var t=new FileReader,a=v()();t.onload=function(e){a.parseFileData(e.target.result).then((function(e){n.props.handleFileUpload(e)})).catch((function(e){n.showError(e.message),n.props.handleIsFileLoading(!1)}))},t.readAsText(e)}},n.showError=function(e){var t=n.state.errors;n.setState({errors:[].concat(Object(l.a)(t),[{id:Object(h.a)(),message:e}])})},n.removeError=function(e){var t=n.state.errors.filter((function(t){return t.id!==e}));n.setState({errors:Object(l.a)(t)})},n.state={inDragArea:!1,errors:[]},n.dragDepth=0,n.dragProps={onDragEnter:n.handleDragEnter,onDragLeave:n.handleDragLeave,onDragOver:n.handleDragOver,onDrop:n.handleDrop},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"file-loader"},r.a.createElement(f,{dragProps:this.dragProps,inDragArea:this.state.inDragArea,handleFile:this.handleFile}),r.a.createElement("div",{className:"error-group"},this.state.errors.map((function(t){return r.a.createElement(p,{key:t.id,message:t.message,index:t.id,removeError:e.removeError})}))))}}]),a}(r.a.Component),b=a(9),C=function(e,t){return new Array(t-e+1).fill().map((function(t,a){return e+a}))},O=function(e,t,a,n){e.preventDefault();var r=parseInt(e.target.value);if("blur"===e.type||"Enter"===e.key)return r>n&&(r=n),r<1&&(r=1),!isNaN(r)&&t(r),void a("");isNaN(r)?a(""):a(r)};function y(e){var t=e.currentPage,a=e.totalPages,i=e.rowsPerPage,o=e.setPage,s=e.setRowsPerPage,c=Object(n.useState)(1),u=Object(b.a)(c,1)[0],m=Object(n.useState)(""),d=Object(b.a)(m,2),p=d[0],h=d[1],f=function(e,t,a){var n=2*e+3;if(t>n+2){var r=Math.max(2,a-e),i=Math.min(t-1,a+e),o=C(r,i),s=r>2,c=t-i>1,u=n-(o.length+1);switch(!0){case!s&&c:var m=C(i+1,i+u);o=[].concat(Object(l.a)(o),Object(l.a)(m),["RIGHT"]);break;case s&&!c:var d=C(r-u,r-1);o=["LEFT"].concat(Object(l.a)(d),Object(l.a)(o));break;case s&&c:default:o=["LEFT"].concat(Object(l.a)(o),["RIGHT"])}return[1].concat(Object(l.a)(o),[t])}return C(1,t)}(u,a,t);return r.a.createElement("div",{className:"pagination"},f.map((function(e){return"LEFT"===e?r.a.createElement("button",{className:"arrow",onClick:function(){return o(t-u-1)},key:e},"\u2190"):"RIGHT"===e?r.a.createElement("button",{className:"arrow",onClick:function(){return o(t+u+1)},key:e},"\u2192"):r.a.createElement("button",{className:e===t?"active":void 0,onClick:function(){return o(e)},key:e},e)})),r.a.createElement("div",{className:"select-wrapper fit-content"},r.a.createElement("select",{value:i,onChange:function(e){return s(parseInt(e.target.value))}},r.a.createElement("option",{value:20},"20/page"),r.a.createElement("option",{value:50},"50/page"),r.a.createElement("option",{value:100},"100/page"))),r.a.createElement("span",{className:"desc"},"Jump To:"),r.a.createElement("input",{type:"number",min:1,max:a,value:p,onChange:function(e){return O(e,o,h,a)},onBlur:function(e){return O(e,o,h,a)},onKeyPress:function(e){return"Enter"===e.key?O(e,o,h,a):null}}))}var N=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).setCoordinates=function(e){var t=r.tooltipRef.current.scrollHeight+e.top-4,a=e.left-5,n=e.top-4;r.setState({left:a,top:e.parentHeight>t?n:n-(t-e.parentHeight)})},r.show=function(){r.setState({isVisible:!0})},r.hide=function(){r.setState({isVisible:!1})},r.state={left:0,top:0,isVisible:!1},r.tooltipRef=Object(n.createRef)(),r}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("span",{ref:this.tooltipRef,className:this.state.isVisible?"tooltip show":"tooltip",style:{left:this.state.left,top:this.state.top}},this.props.children)}}]),a}(n.Component),j=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).tdRef=r.a.createRef(),e.tooltipRef=r.a.createRef(),e.handleOnMouseEnter=function(t){t.preventDefault(),null!==e.tooltipRef.current&&e.tooltipRef.current.show()},e.handleOnMouseLeave=function(t){t.preventDefault(),null!==e.tooltipRef.current&&e.tooltipRef.current.hide()},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){if(null!==this.tooltipRef.current&&null!==this.tdRef.current){var e={left:this.tdRef.current.offsetLeft,top:this.tdRef.current.offsetTop,parentHeight:this.tdRef.current.offsetParent.offsetHeight};this.tooltipRef.current.setCoordinates(e)}}},{key:"render",value:function(){return r.a.createElement("td",{ref:this.tdRef,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave},this.props.value.length>27?r.a.createElement(r.a.Fragment,null,this.props.value.substring(0,26),"...",r.a.createElement(N,{ref:this.tooltipRef},this.props.value)):this.props.value)}}]),a}(n.Component),F=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={currentPage:1,rowsPerPage:50,textFilter:"",sort:{columnId:null,isAscending:!0}},e.sortByColumnn=function(t,a){var n=e.state.sort.columnId?t[e.state.sort.columnId]:t,r=e.state.sort.columnId?a[e.state.sort.columnId]:a;return isNaN(Date.parse(n))||isNaN(Date.parse(r))?isNaN(parseFloat(n))||isNaN(parseFloat(r))?e.state.sort.isAscending?n.localeCompare(r):r.localeCompare(n):(n=parseFloat(n),r=parseFloat(r),e.state.sort.isAscending?n-r:r-n):(n=Date.parse(n),r=Date.parse(r),e.state.sort.isAscending?n-r:r-n)},e.handleSortColumn=function(t,a){t.preventDefault(),e.setState({sort:{columnId:a,isAscending:e.state.sort.columnId!==a||!e.state.sort.isAscending}})},e.handleCancelSortColumn=function(t){t.preventDefault(),e.setState({sort:{columnId:null,isAscending:!0}})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=[];t=""!==this.state.textFilter?this.props.data.filter((function(t){return t.values.some((function(t){return t.includes(e.state.textFilter)}))})):this.props.data,null!==this.state.sort.columnId?t.sort((function(t,a){return e.sortByColumnn(t.values,a.values)})):t.sort((function(t,a){return e.sortByColumnn(t.index,a.index)}));var a=(this.state.currentPage-1)*this.state.rowsPerPage,n=a+this.state.rowsPerPage,i=t.slice(a,n);return r.a.createElement("div",{className:"section"},r.a.createElement("h2",null,"Data View"),r.a.createElement("div",{className:"data-editor"},r.a.createElement("div",{className:"filters"},r.a.createElement("div",{className:"input-icon"},r.a.createElement("span",{className:"icon search-icon"}),r.a.createElement("input",{id:"filterText",name:"filterText",value:this.state.textFilter,onChange:function(t){return e.setState({textFilter:t.target.value})},placeholder:"Filter table...",type:"text"}))),r.a.createElement("div",{className:"table"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"row-number"},"#"),this.props.columns.map((function(t,a){return r.a.createElement("th",{key:"th-".concat(a),onClick:function(t){return e.handleSortColumn(t,a)},onContextMenu:e.handleCancelSortColumn,className:e.state.sort.columnId===a?e.state.sort.isAscending?"asc":"desc":void 0},t," ",e.state.sort.columnId===a&&r.a.createElement("span",{className:"arrow"}))})))),r.a.createElement("tbody",null,i.map((function(t,n){return r.a.createElement("tr",{key:"tr-".concat(t.index)},r.a.createElement("td",{className:"row-number"},a+n+1),t.values.map((function(t,a){return r.a.createElement(j,{key:"td-".concat(a),value:t,columnId:a,rowId:n,handleEditCell:e.props.handleEditCell})})))}))))),r.a.createElement(y,{currentPage:this.state.currentPage,totalPages:Math.ceil(t.length/this.state.rowsPerPage),rowsPerPage:this.state.rowsPerPage,setPage:function(t){return e.setState({currentPage:t})},setRowsPerPage:function(t){return e.setState({rowsPerPage:t})}})))}}]),a}(n.Component),P=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"section"},r.a.createElement("h2",{className:"success"},"File uploaded successfully!"),r.a.createElement("div",{className:"section-content"},"Found ",r.a.createElement("span",{style:{fontWeight:"bold"}},this.props.dataLength)," rows and ",r.a.createElement("span",{style:{fontWeight:"bold"}},this.props.columnsLength)," columns in uploaded file."))}}]),a}(n.Component),w=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"reupload-file"},r.a.createElement("div",{className:"desc"},"Want to upload a new CSV file?"),r.a.createElement("button",{onClick:function(){return e.props.reinitialize()}},"Click here"))}}]),a}(n.Component),I=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.show&&r.a.createElement("div",{className:"section-option"},r.a.createElement("label",{htmlFor:this.props.id},this.props.title),r.a.createElement("div",{className:"select-wrapper"},r.a.createElement("select",{id:this.props.id,name:this.props.id,value:this.props.value,onChange:this.props.onChange},r.a.createElement("option",{value:""}),this.props.columns.map((function(e,t){return r.a.createElement("option",{key:t,value:t},e)}))))))}}]),a}(n.Component),D=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleChangeSectionOption=function(t){var a=parseInt(t.target.value);isNaN(a)&&(a=null),e.props.handleChangeOptionValue(t.target.name,a)},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"section"},r.a.createElement("h2",null,"Choose columns"),r.a.createElement("div",{className:"section-content"},"Columns for Polyline, start timestamp and end timestamp should be assigned automatically if they were found. You can modify it below if it was done incorrectly."),r.a.createElement("div",{className:"section-content"},r.a.createElement(I,{id:"polylineColumnId",title:"Polyline",value:this.props.polylineColumnId,onChange:this.handleChangeSectionOption,columns:this.props.columns,show:!0}),r.a.createElement("div",{className:"section-option"},r.a.createElement("label",{htmlFor:"includePathAnimation"},"Include Path Animation?"),r.a.createElement("input",{type:"checkbox",id:"includePathAnimation",name:"includePathAnimation",checked:this.props.includePathAnimation,onChange:function(t){return e.props.handleChangeOptionValue(t.target.name,t.target.checked)}}),r.a.createElement("div",{className:"section-description"},"Checking this checkbox include start and end timestamps in GeoJSON coordinates. Thanks to this, animating path through time will be possible.")),r.a.createElement(I,{id:"startTimestampColumnId",title:"Start Timestamp",value:this.props.startTimestampColumnId,onChange:this.handleChangeSectionOption,columns:this.props.columns,show:this.props.includePathAnimation}),r.a.createElement(I,{id:"endTimestampColumnId",title:"End Timestamp",value:this.props.endTimestampColumnId,onChange:this.handleChangeSectionOption,columns:this.props.columns,show:this.props.includePathAnimation})))}}]),a}(n.Component),k=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"section"},r.a.createElement("h2",null,"Export File"),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"section-content"},"Set filename and click generate to download GeoJSON file.",r.a.createElement("div",{className:"section-option"},r.a.createElement("label",{htmlFor:"fileName"},"Filename"),r.a.createElement("input",{id:"fileName",name:"fileName",type:"text",value:this.props.fileName,onChange:function(t){return e.props.handleFileNameChange(t.target.value)}}),r.a.createElement("button",{className:"inline",onClick:this.props.generateGeoJSON},"Generate GeoJSON")))))}}]),a}(n.Component),S=a(13),T=a.n(S);var A=function(e){return r.a.createElement("div",{className:"loading"},r.a.createElement("img",{src:T.a,alt:"Loading animation"}),"Please wait...")},L={columns:[],data:[],polylineColumnId:"",startTimestampColumnId:"",endTimestampColumnId:"",includePathAnimation:!1,isFileLoading:!1,isFileUploaded:!1,isGenerating:!1,fileName:"decoded-data"},R=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state=L,e.handleFileUpload=function(t){var a=t.columns,n=void 0===a?[]:a,r=t.data,i=void 0===r?[]:r,o=t.polylineColumnId,l=void 0===o?null:o,s=t.startTimestampColumnId,c=void 0===s?null:s,u=t.endTimestampColumnId,m=void 0===u?null:u;e.setState({columns:n,data:i,polylineColumnId:l,startTimestampColumnId:c,endTimestampColumnId:m,isFileUploaded:!0,isFileLoading:!1})},e.handleChangeOptionValue=function(t,a){return e.setState(Object(s.a)({},t,a))},e.handleIsFileLoading=function(t){return e.setState({isFileLoading:t})},e.handleIsGenerating=function(t){return e.setState({isGenerating:t})},e.handleFileNameChange=function(t){return e.setState({fileName:t})},e.handleEditCell=function(t,a,n){var r=Object(l.a)(e.state.data),i=r.findIndex((function(e){return e.index===a}));r[i].values[n]=t,e.setState({data:r})},e.generateGeoJSON=function(t){t.preventDefault(),e.handleIsGenerating(!0),v()().generateFeatureCollection(e.state.data,e.state.columns,e.state.polylineColumnId,e.state.startTimestampColumnId,e.state.endTimestampColumnId,e.state.includePathAnimation).then((function(t){e.saveData(t),e.handleIsGenerating(!1)})).catch((function(t){console.log(t.message),e.handleIsGenerating(!1)}))},e.saveData=function(t){var a=JSON.stringify(t),n=new Blob([a],{type:"application/json"}),r=URL.createObjectURL(n),i=document.createElement("a");document.body.appendChild(i),i.style="display: none",i.href=r,e.state.fileName?(i.download="".concat(e.state.fileName,".geojson"),i.click(),window.URL.revokeObjectURL(r),i.remove()):console.log("File name is empty")},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"section"},r.a.createElement("h1",null,"Polyline to GeoJSON Decoder"),r.a.createElement("div",{className:"section-content"},"Upload CSV file that contains Polylines to convert them into GeoJSON. Optionally, your file can contain start timestamp and end timestamp for animating paths. Every available column will be converted into Feature properties.")),r.a.createElement("div",{className:"content"},!this.state.isFileLoading&&!this.state.isFileUploaded&&!this.state.isGenerating&&r.a.createElement(E,{handleFileUpload:this.handleFileUpload,handleIsFileLoading:this.handleIsFileLoading}),!this.state.isFileLoading&&this.state.isFileUploaded&&!this.state.isGenerating&&r.a.createElement(r.a.Fragment,null,r.a.createElement(P,{columnsLength:this.state.columns.length,dataLength:this.state.data.length}),r.a.createElement(k,{generateGeoJSON:this.generateGeoJSON,fileName:this.state.fileName,handleFileNameChange:this.handleFileNameChange}),r.a.createElement(D,{columns:this.state.columns,polylineColumnId:this.state.polylineColumnId,startTimestampColumnId:this.state.startTimestampColumnId,endTimestampColumnId:this.state.endTimestampColumnId,includePathAnimation:this.state.includePathAnimation,handleChangeOptionValue:this.handleChangeOptionValue}),r.a.createElement(F,{columns:this.state.columns,data:this.state.data,handleEditCell:this.handleEditCell}),r.a.createElement(w,{reinitialize:function(){return e.setState(L)}})),(this.state.isGenerating||this.state.isFileLoading)&&r.a.createElement(A,null)))}}]),a}(r.a.Component);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root"))},8:function(e,t,a){var n=a(20),r=["parseFileData","generateFeatureCollection"];e.exports=function(){var e=new Worker(a.p+"b06ac8d00f59bc7a3b7c.worker.js",{name:"[hash].worker.js"});return n(e,r),e}}},[[14,1,2]]]);
//# sourceMappingURL=main.470df646.chunk.js.map